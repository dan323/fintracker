const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/PieChartCategoryAccount-Bd_AGQ-m.js","assets/vendor_react-Djc1MftW.js","assets/Toggle-D8Ul_d3S.js","assets/Toggle-DOJTc4a6.css","assets/categories--x47n6Y1.js","assets/vendor_recharts-BHrHECup.js","assets/vendor_clsx-B-dksMZM.js","assets/vendor_lodash-BVkvN6pE.js","assets/vendor_react_smooth-BLudc2bI.js","assets/vendor_prop_types-C8mTKnMW.js","assets/vendor_fast_equals-C7I1S-bJ.js","assets/vendor_tiny_invariant-BaFNuDhB.js","assets/vendor_d3_shape-BEeVWgsp.js","assets/vendor_d3_path-CimkQT29.js","assets/vendor_victory_vendor-kkW58D1l.js","assets/vendor_d3_scale-Boo5rDhd.js","assets/vendor_internmap-BkD7Hj8s.js","assets/vendor_d3_array-g_qRI3rN.js","assets/vendor_d3_time_format-9CwFdMGF.js","assets/vendor_d3_time-BXrU3AQC.js","assets/vendor_d3_interpolate-CKrgWNb4.js","assets/vendor_d3_color-9lF95FHy.js","assets/vendor_d3_format-CzD4bSOQ.js","assets/vendor_recharts_scale-Dc1GUyjq.js","assets/vendor_decimal_js_light-ZKFLnszB.js","assets/vendor_eventemitter3-uOVCADGG.js","assets/vendor_react_dom-_jcUkGts.js","assets/vendor_scheduler-BmyE5rk0.js","assets/vendor_papaparse-MRZiT6g1.js","assets/vendor__msgpack_msgpack-D6VyNCmu.js","assets/vendor_react_router-CAHG2pus.js","assets/vendor_web_vitals-Co-curaW.js","assets/PieChartCategoryAccount-BAQ6c7-n.css","assets/TransactionChart-iSSFDTYQ.js","assets/TransactionChart-CA2qC9Vr.css","assets/CarbonFootPrint-CPl1cEOr.js","assets/CarbonFootPrint-CC8RMWW1.css"])))=>i.map(i=>d[i]);
import{r as p,j as t,R as I}from"./vendor_react-Djc1MftW.js";import{R as _}from"./vendor_react_dom-_jcUkGts.js";import{P as $}from"./vendor_papaparse-MRZiT6g1.js";import{d as G,e as R}from"./vendor__msgpack_msgpack-D6VyNCmu.js";import{B as z}from"./vendor_react_router-CAHG2pus.js";import{w as H,j as V,S as W,G as K,Q as q}from"./vendor_web_vitals-Co-curaW.js";import"./vendor_scheduler-BmyE5rk0.js";(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))i(o);new MutationObserver(o=>{for(const r of o)if(r.type==="childList")for(const c of r.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&i(c)}).observe(document,{childList:!0,subtree:!0});function a(o){const r={};return o.integrity&&(r.integrity=o.integrity),o.referrerPolicy&&(r.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?r.credentials="include":o.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function i(o){if(o.ep)return;o.ep=!0;const r=a(o);fetch(o.href,r)}})();const J="modulepreload",Y=function(e){return"/fintracker/"+e},D={},k=function(n,a,i){let o=Promise.resolve();if(a&&a.length>0){document.getElementsByTagName("link");const c=document.querySelector("meta[property=csp-nonce]"),d=(c==null?void 0:c.nonce)||(c==null?void 0:c.getAttribute("nonce"));o=Promise.allSettled(a.map(l=>{if(l=Y(l),l in D)return;D[l]=!0;const h=l.endsWith(".css"),f=h?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${l}"]${f}`))return;const g=document.createElement("link");if(g.rel=h?"stylesheet":J,h||(g.as="script"),g.crossOrigin="",g.href=l,d&&g.setAttribute("nonce",d),document.head.appendChild(g),h)return new Promise((x,F)=>{g.addEventListener("load",x),g.addEventListener("error",()=>F(new Error(`Unable to preload CSS for ${l}`)))})}))}function r(c){const d=new Event("vite:preloadError",{cancelable:!0});if(d.payload=c,window.dispatchEvent(d),!d.defaultPrevented)throw c}return o.then(c=>{for(const d of c||[])d.status==="rejected"&&r(d.reason);return n().catch(r)})},Q="Cargando...",X={"app.title":"Finanzas personales","account.unknown":"Desconocida","categories.internal":"Interno","categories.main":"CategorÃ­as principales","categories.other":"Otros","action.upload":"Subir movimientos","action.save":"Guardar movimientos",loading:Q,"loading.thinking":"Pensando...","error.load":"Error al cargar el archivo","error.save":"Error al guardar el archivo","duplicates.detected":"Duplicados detectados","duplicate.keep":"Mantener","duplicate.replace":"Reemplazar","duplicate.ignore":"Ignorar","filter.categories":"CategorÃ­as:","filter.selectCategory":"Seleccionar una categorÃ­a","filter.account":"Cuenta:","filter.account.placeholder":"Filtrar por cuenta","filter.start":"Inicio:","filter.end":"Fin:","tab.movements":"Movimientos","tab.chart":"Ingresos y Gastos en el tiempo","tab.pie":"Ingresos y Gastos por categorÃ­as/cuentas","tab.carbon":"Huella de carbono","table.date":"Fecha","table.description":"DescripciÃ³n","table.amount":"Monto","table.category":"CategorÃ­a","table.account":"Cuenta","table.actions":"Acciones","table.edit":"Editar","table.delete":"Eliminar","chart.toggle.show":"siendo mostrados","chart.toggle.group":"siendo agrupadas","chart.toggle.total":"Totales","chart.toggle.account":"Cuentas","chart.toggle.categories":"CategorÃ­as","chart.toggle.separate":"Ingresos y Gastos","chart.toggle.positive":"Ingresos","chart.toggle.negative":"Gastos","button.label.backToAllCategories":"Volver a todas las categorÃ­as","carbon.total":"Total COâ‚‚e","carbon.monthly":"Promedio Mensual","carbon.label.month":"Mes","carbon.topCategory":"CategorÃ­a Principal","carbon.timeline":"LÃ­nea de Tiempo","carbon.byCategory":"Por CategorÃ­as","carbon.monthlyEmissions":"Emisiones Mensuales de COâ‚‚e","carbon.byCategoryTitle":"Emisiones por CategorÃ­a","carbon.recommendations":"ðŸŒ± Recomendaciones para Reducir tu Huella de Carbono","errorBoundary.title":"Â¡Ups! Algo saliÃ³ mal.","errorBoundary.message":`Parece que ha ocurrido un error inesperado.
 Por favor, intenta recargar la pÃ¡gina o vuelve a intentarlo mÃ¡s tarde.`,"errorBoundary.button":"Recargar"},Z="Loading...",ee={"app.title":"Personal Finance","account.unknown":"Unknown Account","categories.internal":"Internal","categories.main":"Main Categories","categories.other":"Other","action.upload":"Upload transactions","action.save":"Save transactions",loading:Z,"loading.thinking":"Thinking...","error.load":"Error loading file","error.save":"Error saving file","duplicates.detected":"Detected duplicates","duplicate.keep":"Keep","duplicate.replace":"Replace","duplicate.ignore":"Ignore","filter.categories":"Categories:","filter.selectCategory":"Select a category","filter.account":"Account:","filter.account.placeholder":"Filter by account","filter.start":"Start:","filter.end":"End:","tab.movements":"Transactions","tab.chart":"Income & Expenses over time","tab.pie":"Income & Expenses by categories/accounts","tab.carbon":"Carbon Footprint","table.date":"Date","table.description":"Description","table.amount":"Amount","table.category":"Category","table.account":"Account","table.actions":"Actions","table.edit":"Edit","table.delete":"Delete","chart.toggle.show":"being shown","chart.toggle.group":"being grouped","chart.toggle.separate":"Income & Expenses","chart.toggle.total":"Totals","chart.toggle.account":"Accounts","chart.toggle.categories":"Categories","chart.toggle.positive":"Revenue","chart.toggle.negative":"Expenses","button.label.backToAllCategories":"Back to all categories","carbon.total":"Total COâ‚‚e","carbon.monthly":"Monthly Average","carbon.label.month":"Month","carbon.topCategory":"Top Category","carbon.timeline":"Timeline","carbon.byCategory":"By Category","carbon.monthlyEmissions":"Monthly COâ‚‚e Emissions","carbon.byCategoryTitle":"Emissions by Category","carbon.recommendations":"ðŸŒ± Recommendations to Reduce Your Carbon Footprint","errorBoundary.title":"Oops! Something went wrong.","errorBoundary.message":`It seems an unexpected error has occurred.
 Please try reloading the page or come back later.`,"errorBoundary.button":"Reload"},S={es:X,en:ee},L=p.createContext(void 0),te=({children:e})=>{const n=()=>{try{const c=window.localStorage.getItem("fintracker_locale");if(E(c))return c}catch{}return"es"},[a,i]=p.useState(n()),o=(c,d="")=>{var h;const l=(h=S[a])==null?void 0:h[c];return l||S.es[c]||S.en[c]||d||c},r=p.useMemo(()=>({locale:a,setLocale:i,t:o}),[a]);return t.jsx(L.Provider,{value:r,children:e})},E=e=>e==="es"||e==="en",b=()=>{const e=p.useContext(L);if(!e)throw new Error("useTranslation must be used within I18nProvider");return{t:e.t,locale:e.locale,setLocale:e.setLocale}};class ne extends p.Component{constructor(n){super(n),this.state={hasError:!1}}static getDerivedStateFromError(n){return{hasError:!0,error:n}}componentDidCatch(n,a){console.error("Error boundary caught an error:",n,a)}render(){const{t:n}=this.props;return this.state.hasError?t.jsxs("div",{className:"error-fallback",children:[t.jsx("h2",{children:n("errorBoundary.title")}),t.jsx("p",{children:n("errorBoundary.message")}),t.jsx("button",{onClick:()=>window.location.reload(),children:n("errorBoundary.reload")})]}):this.props.children}}const ae=({children:e})=>{const{t:n}=b();return t.jsx(ne,{t:n,children:e})},ie=e=>{const n=new Date(e);if(!isNaN(n.getTime()))return n;if(e.includes("/")){const a=e.split("/");if(a.length===3){const i=parseInt(a[0])-1,o=parseInt(a[1]),r=parseInt(a[2]),c=new Date(r,i,o);if(!isNaN(c.getTime()))return c}}return console.warn(`Could not parse date: ${e}`),new Date},oe=({onUpload:e,disabled:n=!1})=>{const{t:a}=b(),i=r=>({...r,date:typeof r.date=="string"?ie(r.date):r.date,amount:typeof r.amount=="string"?parseFloat(r.amount):r.amount}),o=r=>{var d;const c=(d=r.target.files)==null?void 0:d[0];c&&$.parse(c,{header:!0,skipEmptyLines:!0,complete:l=>{const h=l.data.map(f=>({id:crypto.randomUUID(),date:f.date,description:f.description||"",amount:f.amount,category:f.category||a("categories.other"),account:f.account||a("account.unknown")}));e(h.map(i))}})};return t.jsx("input",{type:"file",accept:".csv",onChange:o,disabled:n})},re=({duplicates:e,onResolve:n})=>{const{t:a}=b();return t.jsxs("div",{children:[t.jsx("h3",{children:a("duplicates.detected")}),e.map(i=>t.jsxs("div",{children:[t.jsxs("p",{children:[i.date.toISOString()," - ",i.description," - ",i.amount]}),t.jsx("button",{onClick:()=>n(i,"keep"),children:a("duplicate.keep")}),t.jsx("button",{onClick:()=>n(i,"replace"),children:a("duplicate.replace")}),t.jsx("button",{onClick:()=>n(i,"ignore"),children:a("duplicate.ignore")})]},i.id))]})},M=p.createContext({filters:{},setFilters:()=>{}}),se=({children:e})=>{const[n,a]=p.useState({});return t.jsx(M.Provider,{value:{filters:n,setFilters:a},children:e})},A=()=>p.useContext(M),ce={"food-and-dining":{id:"food-and-dining",name:"Food and Dining"},"food-and-dining-groceries":{id:"food-and-dining-groceries",name:"Groceries",parentId:"food-and-dining"},"food-and-dining-groceries-meat-products":{id:"food-and-dining-groceries-meat-products",name:"Meat Products",parentId:"food-and-dining-groceries",proportion:.3,emissionFactor:3.2},"food-and-dining-groceries-seafood":{id:"food-and-dining-groceries-seafood",name:"Seafood",parentId:"food-and-dining-groceries",proportion:.2,emissionFactor:2.1},"food-and-dining-groceries-vegan-options":{id:"food-and-dining-groceries-vegan-options",name:"Vegan Options",parentId:"food-and-dining-groceries",proportion:.1,emissionFactor:.8},"food-and-dining-groceries-other-processed":{id:"food-and-dining-groceries-other-processed",name:"Other Groceries (Processed)",parentId:"food-and-dining-groceries",proportion:.4,emissionFactor:1.4},"food-and-dining-dining-out":{id:"food-and-dining-dining-out",name:"Dining Out",parentId:"food-and-dining",emissionFactor:2.5},"food-and-dining-delivery-services":{id:"food-and-dining-delivery-services",name:"Delivery Services",parentId:"food-and-dining",emissionFactor:3.1},transport:{id:"transport",name:"Transport"},"transport-public-transport":{id:"transport-public-transport",name:"Public Transport",parentId:"transport",emissionFactor:.15},"transport-private-vehicle-fuel":{id:"transport-private-vehicle-fuel",name:"Private Vehicle Fuel",parentId:"transport"},"transport-private-vehicle-fuel-gasoline":{id:"transport-private-vehicle-fuel-gasoline",name:"Gasoline",parentId:"transport-private-vehicle-fuel",emissionFactor:.82},"transport-private-vehicle-fuel-diesel":{id:"transport-private-vehicle-fuel-diesel",name:"Diesel",parentId:"transport-private-vehicle-fuel",emissionFactor:.95},"transport-private-vehicle-fuel-electric":{id:"transport-private-vehicle-fuel-electric",name:"Electric",parentId:"transport-private-vehicle-fuel",emissionFactor:.25},"transport-air-travel":{id:"transport-air-travel",name:"Air Travel",parentId:"transport"},"transport-air-travel-domestic":{id:"transport-air-travel-domestic",name:"Domestic Flights",parentId:"transport-air-travel",emissionFactor:1.2},"transport-air-travel-international":{id:"transport-air-travel-international",name:"International Flights",parentId:"transport-air-travel",emissionFactor:.8},"transport-taxi":{id:"transport-taxi",name:"Taxi",parentId:"transport",emissionFactor:.45},"transport-rider-services":{id:"transport-rider-services",name:"Rider Services",parentId:"transport",emissionFactor:.38},"housing-and-utilities":{id:"housing-and-utilities",name:"Housing and Utilities"},"housing-and-utilities-electricity":{id:"housing-and-utilities-electricity",name:"Electricity",parentId:"housing-and-utilities"},"housing-and-utilities-electricity-renewable":{id:"housing-and-utilities-electricity-renewable",name:"Electricity (Renewable)",parentId:"housing-and-utilities-electricity",proportion:.6,emissionFactor:.1},"housing-and-utilities-electricity-coal-based":{id:"housing-and-utilities-electricity-coal-based",name:"Electricity (Coal-Based)",parentId:"housing-and-utilities-electricity",proportion:.4,emissionFactor:1.2},"housing-and-utilities-water-usage":{id:"housing-and-utilities-water-usage",name:"Water Usage",parentId:"housing-and-utilities",emissionFactor:.08},"housing-and-utilities-heating":{id:"housing-and-utilities-heating",name:"Heating",parentId:"housing-and-utilities"},"housing-and-utilities-heating-natural-gas":{id:"housing-and-utilities-heating-natural-gas",name:"Heating (Natural Gas)",parentId:"housing-and-utilities-heating",proportion:.5,emissionFactor:.52},"housing-and-utilities-heating-electric":{id:"housing-and-utilities-heating-electric",name:"Heating (Electric)",parentId:"housing-and-utilities-heating",proportion:.5,emissionFactor:.35},"housing-and-utilities-rent-mortgage":{id:"housing-and-utilities-rent-mortgage",name:"Rent/Mortgage",parentId:"housing-and-utilities",emissionFactor:.12},"housing-and-utilities-internet-phone":{id:"housing-and-utilities-internet-phone",name:"Internet/Phone",parentId:"housing-and-utilities",emissionFactor:.18},"housing-and-utilities-comunidad-de-vecinos":{id:"housing-and-utilities-comunidad-de-vecinos",name:"Comunidad de vecinos",parentId:"housing-and-utilities",emissionFactor:.15},"housing-and-utilities-cleaning-service":{id:"housing-and-utilities-cleaning-service",name:"Cleaning Service",parentId:"housing-and-utilities",emissionFactor:.25},"housing-and-utilities-fix-maintenance":{id:"housing-and-utilities-fix-maintenance",name:"Fix/Maintenance",parentId:"housing-and-utilities",emissionFactor:.35},"housing-and-utilities-cloud-services":{id:"housing-and-utilities-cloud-services",name:"Cloud Services and Subscriptions",parentId:"housing-and-utilities",emissionFactor:.22},shopping:{id:"shopping",name:"Shopping"},"shopping-clothing":{id:"shopping-clothing",name:"Clothing",parentId:"shopping"},"shopping-clothing-fast-fashion":{id:"shopping-clothing-fast-fashion",name:"Clothing (Fast Fashion)",parentId:"shopping-clothing",proportion:.2,emissionFactor:4.5},"shopping-clothing-sustainable-brands":{id:"shopping-clothing-sustainable-brands",name:"Clothing (Sustainable Brands)",parentId:"shopping-clothing",proportion:.8,emissionFactor:1.8},"shopping-electronics":{id:"shopping-electronics",name:"Electronics",parentId:"shopping",emissionFactor:2.1},"shopping-furniture-wooden":{id:"shopping-furniture-wooden",name:"Furniture (Wooden)",parentId:"shopping",emissionFactor:1.2},"shopping-furniture-metal":{id:"shopping-furniture-metal",name:"Furniture (Metal)",parentId:"shopping",emissionFactor:2.8},"shopping-personal-care":{id:"shopping-personal-care",name:"Personal Care",parentId:"shopping",emissionFactor:1.1},"shopping-gifts":{id:"shopping-gifts",name:"Gifts",parentId:"shopping",emissionFactor:1.5},"shopping-house-utils":{id:"shopping-house-utils",name:"House Utils",parentId:"shopping",emissionFactor:.85},"entertainment-and-recreation":{id:"entertainment-and-recreation",name:"Entertainment and Recreation"},"entertainment-and-recreation-streaming-services":{id:"entertainment-and-recreation-streaming-services",name:"Streaming Services",parentId:"entertainment-and-recreation",emissionFactor:.35},"entertainment-and-recreation-movies-and-events":{id:"entertainment-and-recreation-movies-and-events",name:"Movies and Events",parentId:"entertainment-and-recreation",emissionFactor:.45},"entertainment-and-recreation-outdoor-activities":{id:"entertainment-and-recreation-outdoor-activities",name:"Outdoor Activities",parentId:"entertainment-and-recreation",emissionFactor:.25},"entertainment-and-recreation-travel-and-tourism-hotels":{id:"entertainment-and-recreation-travel-and-tourism-hotels",name:"Travel and Tourism (Hotels)",parentId:"entertainment-and-recreation",emissionFactor:.65},"entertainment-and-recreation-gym-membership":{id:"entertainment-and-recreation-gym-membership",name:"Gym Membership",parentId:"entertainment-and-recreation",emissionFactor:.32},"entertainment-and-recreation-video-games":{id:"entertainment-and-recreation-video-games",name:"Video Games",parentId:"entertainment-and-recreation",emissionFactor:.28},"entertainment-and-recreation-physical-games":{id:"entertainment-and-recreation-physical-games",name:"Physical Games",parentId:"entertainment-and-recreation",emissionFactor:.95},healthcare:{id:"healthcare",name:"Healthcare"},"healthcare-medication":{id:"healthcare-medication",name:"Medication",parentId:"healthcare",emissionFactor:1.8},"healthcare-health-services":{id:"healthcare-health-services",name:"Health Services",parentId:"healthcare",emissionFactor:.55},"healthcare-supplements":{id:"healthcare-supplements",name:"Supplements",parentId:"healthcare",emissionFactor:1.2},education:{id:"education",name:"Education"},"education-books":{id:"education-books",name:"Books",parentId:"education"},"education-books-physical":{id:"education-books-physical",name:"Books (Physical)",parentId:"education-books",emissionFactor:1.1},"education-books-digital":{id:"education-books-digital",name:"Books (Digital)",parentId:"education-books",emissionFactor:.05},"education-online-courses":{id:"education-online-courses",name:"Online Courses",parentId:"education",emissionFactor:.12},"education-school-supplies":{id:"education-school-supplies",name:"School Supplies",parentId:"education",emissionFactor:.65},miscellaneous:{id:"miscellaneous",name:"Miscellaneous"},"miscellaneous-donations":{id:"miscellaneous-donations",name:"Donations",parentId:"miscellaneous",emissionFactor:.02},"miscellaneous-pet-care":{id:"miscellaneous-pet-care",name:"Pet Care",parentId:"miscellaneous",emissionFactor:1.5},"miscellaneous-hobbies":{id:"miscellaneous-hobbies",name:"Hobbies",parentId:"miscellaneous",emissionFactor:.85},"miscellaneous-others":{id:"miscellaneous-others",name:"Others",parentId:"miscellaneous",emissionFactor:.5},"miscellaneous-internal":{id:"miscellaneous-internal",name:"Internal",parentId:"miscellaneous",emissionFactor:0},"miscellaneous-lawyer":{id:"miscellaneous-lawyer",name:"Lawyer",parentId:"miscellaneous",emissionFactor:.15},"taxes-fees":{id:"taxes-fees",name:"Taxes/Fees"},"taxes-fees-income-tax":{id:"taxes-fees-income-tax",name:"Income Tax",parentId:"taxes-fees",emissionFactor:.08},"taxes-fees-property-tax":{id:"taxes-fees-property-tax",name:"Property Tax",parentId:"taxes-fees",emissionFactor:.05},"taxes-fees-customs-duties":{id:"taxes-fees-customs-duties",name:"Customs Duties",parentId:"taxes-fees",emissionFactor:.12},"taxes-fees-currency-exchange-fees":{id:"taxes-fees-currency-exchange-fees",name:"Currency Exchange Fees",parentId:"taxes-fees",emissionFactor:.02}},le={"income-salary-and-wages":{id:"income-salary-and-wages",name:"Salary and Wages"},"income-salary-and-wages-full-time-job":{id:"income-salary-and-wages-full-time-job",name:"Full-Time Job",parentId:"income-salary-and-wages"},"income-salary-and-wages-part-time-job":{id:"income-salary-and-wages-part-time-job",name:"Part-Time Job",parentId:"income-salary-and-wages"},"income-salary-and-wages-overtime-and-bonuses":{id:"income-salary-and-wages-overtime-and-bonuses",name:"Overtime and Bonuses",parentId:"income-salary-and-wages"}},y={...ce,...le},Ae=(e,n="EU")=>{var i;return((i={"housing-and-utilities-electricity":{EU:1,NO:.1,FR:.3,DE:1.2,PL:1.8,US:1.1,CN:2},"transport-private-vehicle-fuel-electric":{EU:1,NO:.2,PL:2.5,FR:.4}}[e])==null?void 0:i[n])||1},de=()=>{const{t:e}=b(),{setFilters:n}=A(),[a,i]=p.useState([]),[o,r]=p.useState(""),[c,d]=p.useState(new Date("2010-01-01")),[l,h]=p.useState(new Date),f=s=>{const u=s.getFullYear(),m=String(s.getMonth()+1).padStart(2,"0"),v=String(s.getDate()).padStart(2,"0");return`${u}-${m}-${v}`},g=s=>{n(u=>({...u,...s}))},x=s=>{const u=y||{};return u[s]&&u[s].parentId?1+x(u[s].parentId):0},F=s=>{const u=s||{};return Object.keys(u).flatMap(m=>{const v="-".repeat(x(m));return t.jsx("option",{value:m,children:v+u[m].name},m)})},C=s=>{const u=s.target.value;if(u==="")return;const m=[...a,u];i(m),g({categories:m})},w=s=>{const u=a.filter(m=>m!==s);i(u),g({categories:u})};return t.jsxs("div",{className:"filter-bar",children:[t.jsx("label",{htmlFor:"category-select",children:e("filter.categories")}),t.jsxs("select",{id:"category-select",value:"",onChange:C,children:[t.jsx("option",{value:"",children:e("filter.selectCategory")}),F(y)]}),t.jsx("div",{className:"selected-categories",children:a.map(s=>t.jsxs("span",{className:"category-tag",children:[y[s].name,t.jsx("button",{className:"remove-category",onClick:()=>w(s),title:`Remove ${y[s].name}`,children:"Ã—"})]},s))}),t.jsx("label",{htmlFor:"account-input",children:e("filter.account")}),t.jsx("input",{id:"account-input",type:"text",placeholder:e("filter.account.placeholder"),value:o,onChange:s=>{const u=s.target.value;r(u),g({account:u})}}),t.jsxs("div",{className:"date-range",children:[t.jsx("label",{htmlFor:"start-date",children:e("filter.start")}),t.jsx("input",{id:"start-date",type:"date",value:f(c),onChange:s=>{const u=new Date(s.target.value);d(u),g({dateRange:{start:u,end:l}})},onKeyDown:s=>s.preventDefault()}),t.jsx("label",{htmlFor:"end-date",children:e("filter.end")}),t.jsx("input",{id:"end-date",type:"date",value:f(l),onChange:s=>{const u=new Date(s.target.value);h(u),g({dateRange:{start:c,end:u}})},onKeyDown:s=>s.preventDefault()})]})]})},ue=({className:e,states:n,stateTexts:a,onToggle:i,label:o})=>{const[r,c]=p.useState(n[0]);return t.jsxs("div",{className:e,children:[n.map(d=>{const l=t.jsx("div",{className:`toggle-switch ${d.toString()}`,onClick:()=>{c(h=>(i(d),d))},children:t.jsx("span",{className:"toggle-text",children:a.get(d)})},`toggle-${d.toString()}`);return r!==d&&l}),t.jsxs("span",{className:"toggle-span",children:[t.jsx("div",{className:`toggle-switch ${r.toString()}`,style:{marginRight:"15px",marginLeft:"15px"},children:t.jsx("span",{className:"toggle-text",children:a.get(r)})}),o]})]})},pe=({transactions:e,onEdit:n,onDelete:a})=>{const{t:i}=b(),[o,r]=p.useState(""),c=e.filter(l=>o==="negative"?l.amount<0:o==="positive"?l.amount>0:!0).sort((l,h)=>new Date(l.date).getTime()-new Date(h.date).getTime()),d=new Map;return d.set("",i("chart.toggle.total")),d.set("positive",i("chart.toggle.positive")),d.set("negative",i("chart.toggle.negative")),t.jsxs("div",{children:[t.jsx(ue,{className:"toggle-container",label:i("chart.toggle.show"),states:["","positive","negative"],stateTexts:d,onToggle:l=>r(l)}),t.jsxs("table",{className:"transaction-table",children:[t.jsx("thead",{children:t.jsxs("tr",{children:[t.jsx("th",{children:i("table.date")}),t.jsx("th",{children:i("table.description")}),t.jsx("th",{children:i("table.amount")}),t.jsx("th",{children:i("table.category")}),t.jsx("th",{children:i("table.account")}),t.jsx("th",{children:i("table.actions")})]},"header-row")}),t.jsx("tbody",{children:c.map(l=>t.jsxs("tr",{children:[t.jsx("td",{children:`${l.date.toISOString().slice(0,10)}`}),t.jsx("td",{children:l.description}),t.jsx("td",{children:l.amount.toFixed(2)}),t.jsx("td",{children:l.category}),t.jsx("td",{children:l.account}),t.jsxs("td",{children:[t.jsx("button",{className:"edit-btn",onClick:()=>n(l),children:i("table.edit")}),t.jsx("button",{className:"delete-btn",onClick:()=>a(l.id),children:i("table.delete")})]})]},l.id))})]})]})},me=(e,n)=>e.filter(a=>n.some(i=>a.date.toISOString()===i.date.toISOString()&&a.amount===i.amount&&a.account===i.account));async function ge(e,n){const a=R(e),i=await n.createWritable();await i.write(a),await i.close()}async function he(e){const n=R(e),a=new Blob([n],{type:"application/octet-stream"}),i=URL.createObjectURL(a),o=document.createElement("a");o.href=i,o.download="transactions.msgpack",document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL(i)}async function fe(e,n){return e.getFile().then(n)}async function T(e){const n=await e.arrayBuffer();return G(new Uint8Array(n)).map((a,i)=>a.id?a:{...a,id:String(i)})}async function P(e){const n=await e.text();return JSON.parse(n)}const j=e=>Array.isArray(e)?e.map(j):e!==null&&typeof e=="object"?Object.keys(e).reduce((n,a)=>(n[a.toLowerCase()]=j(e[a]),n),{}):e,ve=e=>({...e,date:typeof e.date=="string"?new Date(e.date):e.date,amount:typeof e.amount=="string"?parseFloat(e.amount):e.amount}),O=e=>e.map(ve);async function be(e){if("showSaveFilePicker"in window)try{const n=await window.showSaveFilePicker({suggestedName:"transactions.msgpack",types:[{description:"MessagePack File",accept:{"application/octet-stream":[".msgpack"]}}]});ge(e,n)}catch(n){throw console.error("Error saving file:",n),n}else he(e)}async function ye(){try{if(window.showOpenFilePicker){const[e]=await window.showOpenFilePicker({types:[{description:"MessagePack File",accept:{"application/octet-stream":[".msgpack"]}},{description:"JSON File",accept:{"application/json":[".json"]}}]});let n;(await e.getFile()).name.includes(".msgpack")?n=T:n=P;const i=await fe(e,n),o=j(i);return O(o)}else return alert("Your browser does not support advanced file selection. Using fallback."),new Promise((e,n)=>{const a=document.createElement("input");a.type="file",a.accept=".msgpack,.json",a.onchange=async()=>{if(a.files&&a.files[0])try{const i=a.files[0];let o;i.name.endsWith(".msgpack")?o=T:o=P;const r=await o(i),c=j(r);e(O(c))}catch(i){n(i)}else n(new Error("No file selected."))},a.click()})}catch(e){throw console.error("Error loading file:",e),e}}const xe=(e,n)=>n.some(a=>B(e,a)),B=(e,n)=>e===n?!0:y[e]?y[e].parentId?B(y[e].parentId,n):!1:n==="Others",Fe=e=>{const{filters:n}=A();return p.useMemo(()=>e.filter(a=>{if(!a.date||!(a.date instanceof Date))return console.warn("Transaction has invalid date:",a),!1;if(n.dateRange){const i=new Date(a.date),{start:o,end:r}=n.dateRange;if(i<o||i>r)return!1}if(n.account&&a.account!==n.account)return!1;if(n.categories&&n.categories.length>0){const i=n.categories;if(!xe(a.category,i))return!1}return!0}),[e,n])},je=({activeTab:e,setActiveTab:n})=>{const{t:a}=b();return t.jsxs("div",{className:"tabs",children:[t.jsx("button",{className:`tab-button ${e==="table"?"active":""}`,onClick:()=>n("table"),children:a("tab.movements")}),t.jsx("button",{className:`tab-button ${e==="chart"?"active":""}`,onClick:()=>n("chart"),children:a("tab.chart")}),t.jsx("button",{className:`tab-button ${e==="pie"?"active":""}`,onClick:()=>n("pie"),children:a("tab.pie")}),t.jsx("button",{className:`tab-button ${e==="carbon"?"active":""}`,onClick:()=>n("carbon"),children:a("tab.carbon")})]})},N="fintracker_locale",Ie=()=>{const{locale:e,setLocale:n}=b();p.useEffect(()=>{const i=window.localStorage.getItem(N);i&&i!==e&&E(i)&&n(i)},[]);const a=i=>{const o=i.target.value;if(E(o)){n(o);try{window.localStorage.setItem(N,o)}catch{}}else console.warn(`Unsupported locale selected: ${o}`)};return t.jsxs("select",{"aria-label":"Language",value:e,onChange:a,children:[t.jsx("option",{value:"es",children:"EspaÃ±ol"}),t.jsx("option",{value:"en",children:"English"})]})},Ce=I.lazy(()=>k(()=>import("./PieChartCategoryAccount-Bd_AGQ-m.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32]))),we=I.lazy(()=>k(()=>import("./TransactionChart-iSSFDTYQ.js"),__vite__mapDeps([33,1,2,3,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,34]))),Se=I.lazy(()=>k(()=>import("./CarbonFootPrint-CPl1cEOr.js"),__vite__mapDeps([35,1,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,36]))),Ee=()=>{const{t:e}=b(),[n,a]=p.useState([]),[i,o]=p.useState([]),[r,c]=p.useState("table"),[d,l]=p.useState(!1),[h,f]=p.useState(null),g=Fe(n),x=async()=>{try{l(!0),f(null),console.log("Opening file..."),await ye().then(a)}catch(s){console.log("No file selected or error loading file:",s),f(e("error.load"))}finally{l(!1)}},F=async()=>{try{l(!0),f(null),await be(n)}catch(s){console.log("Error saving file:",s),f(e("error.save"))}finally{l(!1)}},C=s=>{const u=me(s,n);o(u);const m=s.filter(v=>!u.some(U=>U.id===v.id));a(v=>[...v,...m]),F()},w=(s,u)=>{u==="keep"?a(m=>[...m,s]):u==="replace"&&a(m=>m.map(v=>v.id===s.id?s:v)),o(m=>m.filter(v=>v.id!==s.id))};return t.jsx(ae,{children:t.jsx(z,{basename:"/fintracker/",children:t.jsxs("div",{className:"app-container",children:[t.jsx("h1",{className:"app-title",children:e("app.title")}),h&&t.jsxs("div",{className:"error-message",children:[h,t.jsx("button",{onClick:()=>f(null),children:"Ã—"})]}),t.jsxs("div",{className:"app-controls",children:[t.jsx("button",{className:"action-button",onClick:x,children:e(d?"loading.thinking":"action.upload")}),t.jsx("button",{className:"action-button",onClick:F,children:e(d?"loading.thinking":"action.save")}),t.jsx(oe,{onUpload:C,disabled:d}),t.jsx(Ie,{})]}),d&&t.jsx("div",{className:"loading-spinner",children:e("loading")}),t.jsx(de,{}),t.jsx(je,{activeTab:r,setActiveTab:c}),t.jsxs("div",{className:"tab-content",children:[r==="table"&&t.jsxs(t.Fragment,{children:[t.jsx(pe,{transactions:g,onEdit:s=>console.log("Edit:",s),onDelete:s=>a(u=>u.filter(m=>m.id!==s))}),i.length>0&&t.jsx(re,{duplicates:i,onResolve:w})]}),r==="chart"&&t.jsx(p.Suspense,{fallback:t.jsxs("div",{children:["$",e("loading")]}),children:t.jsx(we,{transactions:g})}),r==="pie"&&t.jsx(p.Suspense,{fallback:t.jsxs("div",{children:["$",e("loading")]}),children:t.jsx(Ce,{transactions:g})}),r==="carbon"&&t.jsx(p.Suspense,{fallback:t.jsxs("div",{children:["$",e("loading")]}),children:t.jsx(Se,{transactions:g})})]})]})})})},ke=e=>{e&&e instanceof Function&&(H(e),V(e),W(e),K(e),q(e))},De=_.createRoot(document.getElementById("root"));De.render(t.jsx(I.StrictMode,{children:t.jsx(te,{children:t.jsx(se,{children:t.jsx(Ee,{})})})}));ke(console.log);export{ue as T,y as c,Ae as g,b as u};
